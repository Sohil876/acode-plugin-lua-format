/*! For license information please see main.js.LICENSE.txt */
!function(){var e={418:function(e,n,t){var o=t(473);n.Beautify=o.Beautify,n.Minify=o.Minify,n.Uglify=o.Uglify},473:function(e,n,t){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}function r(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,n){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var o,r,i=[],a=!0,u=!1;try{for(t=t.call(e);!(a=(o=t.next()).done)&&(i.push(o.value),!n||i.length!==n);a=!0);}catch(e){u=!0,r=e}finally{try{a||null==t.return||t.return()}finally{if(u)throw r}}return i}}(e,n)||function(e,n){if(e){if("string"==typeof e)return i(e,n);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?i(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,n){(null==n||n>e.length)&&(n=e.length);for(var t=0,o=new Array(n);t<n;t++)o[t]=e[t];return o}e=t.nmd(e);var a=console.log,u=(console.error,function(e,n){if(!e)throw n});function l(e,n){if(!e)return 0;var t=e.toString().split(".");return t.length>1?parseInt(t[0],n)+parseInt(t[1],n)/Math.pow(n,t[1].length):parseInt(t[0],n)}var s=[" ","\n","\t","\r"],c=new Proxy({r:"\r",n:"\n",t:"\t",'"':'"',"'":"'","\\":"\\"},{get:function(e,n){return l(n)}}),f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],T=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","_","a","b","c","d","e","f","g","t","u","v","w","h","i","j","k","l","m","n","o","p","q","r","s","x","y","z"],p=["0","1","2","3","4","5","6","7","8","9"],h=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","A","B","C","D","E","F"],y=["0","1"],k=["+","-","*",")",";","/","^","%","#",",","{","}",":","[","]","(",".","`"],L=["~","=",">","<"],d=["+","-","*","/","^","..","%"],S=["+=","-=","*=","/=","^=","..=","%="],m=["and","break","do","else","elseif","end","false","for","function","goto","if","in","local","nil","not","or","repeat","return","then","true","until","while","continue"],g=["else","elseif","until","end"],E=["-","not","#","~"],v=["+","-","*","/","%","^","#","//","&","|","~","<<",">>","..",".",":",">","<","<=",">=","~=","==","+=","-=","*=","/=","%=","^=","..=","and","or"],_={"^":[13,12],"%":[10,10],"//":[10,10],"/":[10,10],"*":[10,10],"+":[9,9],"-":[9,9],"..":[8,7],">>":[7,7],"<<":[7,7],"&":[6,6],"~":[5,5],"|":[4,4],"==":[3,3],"~=":[3,3],">=":[3,3],"<=":[3,3],">":[3,3],"<":[3,3],"+=":[3,3],"-=":[3,3],"*=":[3,3],"/=":[3,3],"^=":[3,3],"%=":[3,3],"..=":[3,3],and:[2,2],or:[1,1]};function C(e){var n,t,o=function(e){var n=0,t=e.length,o=[];function r(o){return o=o||0,n<=t?e.substr(n+o,1):""}function i(){if(n<=t){var o=e.substr(n,1);return n++,o}return""}function u(t){for(var r,i=1,u=1;0<=n;)"\n"==e.substr(0,1)?(i++,u=1):u++;for(r=0;r<o.length;r++){var l=o[r];a("".concat(l.Type,"<").concat(l.Source,">"))}throw"file<".concat(i,":").concat(u,">: ").concat(t)}function l(e){for(;;){var t=i();if(""==t)u("Unfinished long string.");else if("]"==t){var o=!0,a=void 0;for(a=1;a<=e;a++){if("="!=r()){o=!1;break}n++}if(o&&"]"==i())return}}}function S(){for(var e=n;"="==r();)n++;return"["==r()?++n-e-1:void(n=e)}var g=0,E=0;function _(t){var r=e.substr(E,n-E),i=null;"Number"==t&&("0x"==r.substr(0,2).toLowerCase()?(i="hex",parseInt(r,16)<999999999999&&(r=parseInt(r,16))):"0b"==r.substr(0,2).toLowerCase()&&(i="bin",parseInt(r.substr(2),2)<999999999999&&(r=parseInt(r.substr(2),2))));var a={Type:t,LeadingWhite:e.substr(g,E-g),Source:r};return null!==i&&(a.NType=i),o.push(a),g=n,E=n,a}for(;;){for(g=n;;){var C=r();if(""==C)break;if("-"==C){if("-"!=r(1))break;if(n+=2,"["==r()){n++;var x=S();if(null!=x)l(x),g=n;else for(;;){var F=i();if(""==F||"\n"==F)break}}else for(;;){var b=i();if(""==b||"\n"==b)break}}else{if(!s.includes(C))break;n++}}e.substr(g,n-g),E=n;var B=i();if(""==B){_("Eof");break}if("'"==B||'"'==B){for(;;){var G=i();if("\\"==G){var V=i();if(null==c[V])throw"Invalid Escape Sequence `".concat(V,"`.")}else{if(G==B)break;if(""==G)throw"Unfinished string!"}}_("String")}else if("`"==B){for(;;){var R=i();if("\\"==R){var A=i();if(null==c[A])throw"Invalid Escape Sequence `".concat(A,"`.")}else{if(R==B)break;if(""==R)throw"Unfinished string!"}}_("Hash")}else if(f.includes(B)){for(;T.includes(r());)n++;m.includes(e.substr(E,n-E))?_("Keyword"):_("Ident")}else if(p.includes(B)||"."==B&&p.includes(r())){if("0"==B&&"x"==r().toLowerCase())for(n++;h.includes(r())||"_"===r();)n++;else if("0"==B&&"b"==r().toLowerCase())for(n++;y.includes(r())||"_"===r();)n++;else{for(;p.includes(r())||"_"===r();)n++;if("."==r())for(n++;p.includes(r());)n++;if("e"==r()||"E"==r())for(n++,"-"!=r()&&"+"!=r()||n++;p.includes(r());)n++}_("Number")}else if("["==B){var w=S();null!=w?(l(w),_("String")):_("Symbol")}else if("."==B)"."==r()&&(i(),("."==r()||"="==r())&&i()),_("Symbol");else if(v.includes(B+r()))i(),_("Symbol");else if(L.includes(B))"="==r()&&n++,_("Symbol");else if(d.includes(B)&&"="==r())i(),_("Symbol");else{if(!k.includes(B))throw"Bad symbol `".concat(B,"` in source. ").concat(n);_("Symbol")}}return o}(e),i=0;function l(){var e=o[i];return i<o.length&&i++,e}function C(e){return o[e=i+(e||0)]||o[o.length-1]}function x(e){for(var n=1,t=0,r=0;;){var i=o[r],a=void 0;a=i==e?i.LeadingWhite:i.LeadingWhite+i.Source;var u=void 0;for(u=0;u<=a.length;u++)"\n"==a.substr(u,1)?(n++,t=0):t++;if(i==e)break;r++}return"".concat(n,":").concat(t+1)}function F(){var e=C();return"Eof"==e.Type||"Keyword"==e.Type&&g.includes(e.Source)}function b(e,n){var t=C();if(t.Type!=e||null!=n&&t.Source!=n){var o;for(o=-3;o<=3;o++)a("Tokens[".concat(o,"] = `").concat(C(o).Source,"`"));if(n)throw"".concat(x(t),": `").concat(n,"` expected.");throw"".concat(x(t),": ").concat(e," expected.")}return l()}function B(e){var n=e.GetFirstToken,t=e.GetLastToken,o=e;return e.GetFirstToken=function(){var e=n(o);return u(e),e},e.GetLastToken=function(){var e=t(o);return u(e),e},e}function G(e,n){for(var o=[t(e,n)],r=[];","==C().Source;)r.push(l()),o.push(t(e,n));return[o,r]}function V(e){var n=[],t=[];if("Ident"==C().Type)n.push(l());else if("..."==C().Source&&e)return[n,t,l()];for(;","==C().Source;){if(t.push(l()),"..."==C().Source&&e)return[n,t,l()];var o=b("Ident");n.push(o)}return[n,t]}function R(e,t,o){var r=n(t,o),i=C();if("Keyword"==i.Type&&i.Source==e)return l(),[r,i];throw a(i.Type,i.Source),"".concat(x(i),": ").concat(e," expected.")}function A(e,n,t,o){var i,a,u=l();if(!e){i=[],a=[];var s=b("Ident");for(i.push(s);"."==C().Source;)a.push(l()),i.push(b("Ident"));":"==C().Source&&(a.push(l()),i.push(b("Ident")))}var c,f=b("Symbol","("),T=r(V(!0),3),p=T[0],h=T[1],y=T[2],k=b("Symbol",")"),L=r(R("end",n,t),2),d=L[0],S=L[1];return c=B({Type:1==e?"FunctionLiteral":"FunctionStat",NameChain:i,ArgList:p,Body:d,Token_Function:u,Token_NameChainSeperator:a,Token_OpenParen:f,Token_Varg:y,Token_ArgCommaList:h,Token_CloseParen:k,Token_End:S,GetFirstToken:function(){return c.Token_Function},GetLastToken:function(){return c.Token_End}})}function w(e,n){var o,r,i=C();if("("==i.Source){for(var a=l(),u=[],s=[];")"!=C().Source&&(u.push(t(e,n)),","==C().Source);)s.push(l());var c,f=b("Symbol",")");return c=B({CallType:"ArgCall",ArgList:u,Token_CommaList:s,Token_OpenParen:a,Token_CloseParen:f,GetFirstToken:function(){return c.Token_OpenParen},GetLastToken:function(){return c.Token_CloseParen}})}if("{"==i.Source)return o=B({CallType:"TableCall",TableExpr:t(e,n),GetFirstToken:function(){return o.TableExpr.GetFirstToken()},GetLastToken:function(){return o.TableExpr.GetLastToken()}});if("String"==i.Type)return r=B({CallType:"StringCall",Token:l(),GetFirstToken:function(){return r.Token},GetLastToken:function(){return r.Token}});throw"Function arguments expected."}function N(e,n){var o=function(e,n){var o,r=C();if("("==r.Source){var i,u=l(),s=t(e,n),c=b("Symbol",")");return i=B({Type:"ParenExpr",Expression:s,Token_OpenParen:u,Token_CloseParen:c,GetFirstToken:function(){return i.Token_OpenParen},GetLastToken:function(){return i.Token_CloseParen}})}if("Ident"==r.Type)return null!=e[(o=B({Type:"VariableExpr",Token:l(),GetFirstToken:function(){return o.Token},GetLastToken:function(){return o.Token}})).Token.Source]?(e[o.Token.Source].Tokens.push(o.Token),e[o.Token.Source].UseCountIncrease()):null!=n[o.Token.Source]&&(n[o.Token.Source].Tokens.push(o.Token),n[o.Token.Source].UseCountIncrease()),o;throw a(function(){var e=C();return"<".concat(e.Type," `").concat(e.Source,"`> at: ").concat(x(e))}()),"".concat(x(r),": Unexpected symbol. ").concat(r.Type," ").concat(r.Source)}(e,n);for(u(o,"nil prefixexpr");;){var r=C();if("."==r.Source)!function(){var e=l(),n=b("Ident"),t=void 0;t=B({Type:"FieldExpr",Base:o,Field:n,Token_Dot:e,GetFirstToken:function(){return t.Base.GetFirstToken()},GetLastToken:function(){return t.Field}}),o=t}();else if(":"==r.Source)!function(){var t=l(),r=b("Ident"),i=w(e,n),a=void 0;a=B({Type:"MethodExpr",Base:o,Method:r,FunctionArguments:i,Token_Colon:t,GetFirstToken:function(){return a.Base.GetFirstToken()},GetLastToken:function(){return a.FunctionArguments.GetLastToken()}}),o=a}();else if("["==r.Source)!function(){var r=l(),i=t(e,n),a=b("Symbol","]"),u=void 0;u=B({Type:"IndexExpr",Base:o,Index:i,Token_OpenBracket:r,Token_CloseBracket:a,GetFirstToken:function(){return u.Base.GetFirstToken()},GetLastToken:function(){return u.Token_CloseBracket}}),o=u}();else if("{"==r.Source||"("==r.Source||"String"==r.Type)!function(){var t=void 0;t=B({Type:"CallExpr",Base:o,FunctionArguments:w(e,n),GetFirstToken:function(){return t.Base.GetFirstToken()},GetLastToken:function(){return t.FunctionArguments.GetLastToken()}}),o=t}();else{if(!S.includes(r.Source))return o;!function(){var r=l(),i=t(e,n),a=void 0;a=B({Type:"CompoundStat",Base:o,Token_Compound:r,Rhs:i,Lhs:o,GetFirstToken:function(){return a.Base.GetFirstToken()},GetLastToken:function(){return a.Rhs.GetLastToken()}}),o=a}()}}}function P(e,n,o){var r;if(E.includes(C().Source)){var i,a=l(),s=P(11,n,o);i=B({Type:"UnopExpr",Token_Op:a,Rhs:s,GetFirstToken:function(){return i.Token_Op},GetLastToken:function(){return i.Rhs.GetLastToken()}}),r=i}else r=function(e,n){var o,r,i,a,u,s,c=C();return"Number"==c.Type?o=B({Type:"NumberLiteral",Token:l(),GetFirstToken:function(){return o.Token},GetLastToken:function(){return o.Token}}):"String"==c.Type?r=B({Type:"StringLiteral",Token:l(),GetFirstToken:function(){return r.Token},GetLastToken:function(){return r.Token}}):"Hash"==c.Type?i=B({Type:"HashLiteral",Token:l(),GetFirstToken:function(){return i.Token},GetLastToken:function(){return i.Token}}):"nil"==c.Source?a=B({Type:"NilLiteral",Token:l(),GetFirstToken:function(){return a.Token},GetLastToken:function(){return a.Token}}):"true"==c.Source||"false"==c.Source?u=B({Type:"BooleanLiteral",Token:l(),GetFirstToken:function(){return u.Token},GetLastToken:function(){return u.Token}}):"..."==c.Source?s=B({Type:"VargLiteral",Token:l(),GetFirstToken:function(){return s.Token},GetLastToken:function(){return s.Token}}):"{"==c.Source?function(e,n){for(var o=b("Symbol","{"),r=[],i=[];"}"!=C().Source;){if("["==C().Source){var a=l(),u=t(e,n),s=b("Symbol","]"),c=b("Symbol","="),f=t(e,n);u.Token&&u.Token.Source,r.push({EntryType:"Index",Index:u,Value:f,Token_OpenBracket:a,Token_CloseBracket:s,Token_Equals:c})}else if("Ident"==C().Type&&"="==C(1).Source){var T=l(),p=l(),h=t(e,n);r.push({EntryType:"Field",Field:T,Value:h,Token_Equals:p})}else{var y=t(e,n);r.push({EntryType:"Value",Value:y})}if(","!=C().Source&&";"!=C().Source)break;i.push(l())}var k,L=b("Symbol","}");return k=B({Type:"TableLiteral",EntryList:r,Token_SeperatorList:i,Token_OpenBrace:o,Token_CloseBrace:L,GetFirstToken:function(){return k.Token_OpenBrace},GetLastToken:function(){return k.Token_CloseBrace}})}(e,n):"function"==c.Source?A(!0,e,n):N(e,n)}(n,o),u(r,"nil sipleexpr");for(var c=function(){var e=l(),t=P(_[e.Source][1],n,o);u(t,"RhsNeeded");var i=void 0;i=B({Type:"BinopExpr",Lhs:r,Rhs:t,Token_Op:e,GetFirstToken:function(){return i.Lhs.GetFirstToken()},GetLastToken:function(){return i.Rhs.GetLastToken()}}),r=i};v.includes(C().Source)&&null!=_[C().Source]&&_[C().Source][0]>e;)c();return r}function I(e,n){var o,r=N(e,n);if("MethodExpr"==r.Type||"CallExpr"==r.Type)return o=B({Type:"CallExprStat",Expression:r,GetFirstToken:function(){return o.Expression.GetFirstToken()},GetLastToken:function(){return o.Expression.GetLastToken()}});if("CompoundStat"==r.Type)return r;for(var i=[r],a=[];","==C().Source;){a.push(l());var u=N(e,n);if("MethodExpr"==u.Type||"CallExpr"==u.Type)throw"Bad left hand side of asignment";i.push(u)}for(var s,c=b("Symbol","="),f=[t(e,n)],T=[];","==C().Source;)T.push(l()),f.push(t(e,n));return s=B({Type:"AssignmentStat",Rhs:f,Lhs:i,Token_Equals:c,Token_LhsSeperatorList:a,Token_RhsSeperatorList:T,GetFirstToken:function(){return s.Lhs[0].GetFirstToken()},GetLastToken:function(){return s.Rhs[s.Rhs.length-1].GetLastToken()}})}function O(e,o){for(var r=l(),i=t(e,o),a=b("Keyword","then"),u=n(e,o),s=[];"elseif"==C().Source||"else"==C().Source;){var c=l(),f=void 0,T=void 0;"elseif"==c.Source&&(f=t(e,o),T=b("Keyword","then"));var p=n(e,o);if(s.push({Condition:f,Body:p,ClauseType:c.Source,Token:c,Token_Then:T}),"else"==c.Source)break}var h,y=b("Keyword","end");return h=B({Type:"IfStat",Condition:i,Body:u,ElseClauseList:s,Token_If:r,Token_Then:a,Token_End:y,GetFirstToken:function(){return h.Token_If},GetLastToken:function(){return h.Token_End}})}function U(e,n){var t,o=l(),i=r(R("end",e,n),2),a=i[0],u=i[1];return t=B({Type:"DoStat",Body:a,Token_Do:o,Token_End:u,GetFirstToken:function(){return t.Token_Do},GetLastToken:function(){return t.Token_End}})}function D(e,n){var o,i=l(),a=t(e,n),u=b("Keyword","do"),s=r(R("end",e,n),2),c=s[0],f=s[1];return o=B({Type:"WhileStat",Condition:a,Body:c,Token_While:i,Token_Do:u,Token_End:f,GetFirstToken:function(){return o.Token_While},GetLastToken:function(){return o.Token_End}})}function M(e,n){var t=l(),o=r(V(),2),i=o[0],a=o[1];if("="==C().Source){var u=l(),s=r(G(e,n),2),c=s[0],f=s[1];if(c.length<2||c.length>3)throw"Expected 2 or 3 values for range bounds";var T,p=b("Keyword","do"),h=r(R("end",e,n),2),y=h[0],k=h[1];return T=B({Type:"NumericForStat",VarList:i,RangeList:c,Body:y,Token_For:t,Token_VarCommaList:a,Token_Equals:u,Token_RangeCommaList:f,Token_Do:p,Token_End:k,GetFirstToken:function(){return T.Token_For},GetLastToken:function(){return T.Token_End}})}if("in"==C().Source){var L,d=l(),S=r(G(e,n),2),m=S[0],g=S[1],E=b("Keyword","do"),v=r(R("end",e,n),2),_=v[0],x=v[1];return L=B({Type:"GenericForStat",VarList:i,GeneratorList:m,Body:_,Token_For:t,Token_VarCommaList:a,Token_In:d,Token_GeneratorCommaList:g,Token_Do:E,Token_End:x,GetFirstToken:function(){return L.Token_For},GetLastToken:function(){return L.Token_End}})}}function W(e,n){var o,i=l(),a=r(R("until",e),2),u=a[0],s=a[1],c=t(e,n);return o=B({Type:"RepeatStat",Body:u,Condition:c,Token_Repeat:i,Token_Until:s,GetFirstToken:function(){return o.Token_Repeat},GetLastToken:function(){return o.Condition.GetLastToken()}})}function j(e,n){var t=l();if("function"==C().Source){var o,i=A(!1,e,n);if(i.NameChain.length>1)throw x(i.Token_NameChainSeperator[0])+": `(` expected.";return o=B({Type:"LocalFunctionStat",FunctionStat:i,Token_Local:t,GetFirstToken:function(){return o.Token_Local},GetLastToken:function(){return o.FunctionStat.GetLastToken()}})}if("Ident"==C().Type){var a,u,s=r(V(!1),2),c=s[0],f=s[1],T=[],p=[];if("="==C().Source){a=l();var h=r(G(e,n),2);T=h[0],p=h[1]}return u=B({Type:"LocalVarStat",VarList:c,ExprList:T,Token_Local:t,Token_Equals:a,Token_VarCommaList:f,Token_ExprCommaList:p,GetFirstToken:function(){return u.Token_Local},GetLastToken:function(){return u.ExprList.length>0?u.ExprList[u.ExprList.length-1].GetLastToken():u.VarList[u.VarList.length-1]}})}throw"`function` or ident expected"}function q(e,n){var t,o,i,a=l();if(F()||";"==C().Source)t=[],o=[];else{var u=r(G(e,n),2);t=u[0],o=u[1]}return i={Type:"ReturnStat",ExprList:t,Token_Return:a,Token_CommaList:o,GetFirstToken:function(){return i.Token_Return},GetLastToken:function(){return i.ExprList.length>0?i.ExprList[i.ExprList.length-1].GetLastToken():i.Token_Return}}}function H(e,n){var t,o=l();return t={Type:"ContinueStat",Token_Continue:o,GetFirstToken:function(){return t.Token_Continue},GetLastToken:function(){return t.Token_Continue}}}function K(e,n){var t,o,r=C();return"if"==r.Source?[!1,O(e,n)]:"while"==r.Source?[!1,D(e,n)]:"do"==r.Source?[!1,U(e,n)]:"for"==r.Source?[!1,M(e,n)]:"repeat"==r.Source?[!1,W(e,n)]:"function"==r.Source?[!1,A(!1,e,n)]:"local"==r.Source?[!1,j(e,n)]:"return"==r.Source?[!0,q(e,n)]:"break"==r.Source?[!0,(o=l(),t={Type:"BreakStat",Token_Break:o,GetFirstToken:function(){return t.Token_Break},GetLastToken:function(){return t.Token_Break}})]:"continue"==r.Source?[!0,H()]:[!1,I(e,n)]}return t=function(e,n){return P(0,e,n)},n=function(e,n){var t,o=[],i=[],u={},s={};if(null!=n)for(var c=0,f=Object.entries(n);c<f.length;c++){var T=r(f[c],2),p=T[0],h=T[1];s[p]=h}if(null!=e)for(var y=0,k=Object.entries(e);y<k.length;y++){var L=r(k[y],2),d=L[0],S=L[1];s[d]=S}for(var m,g=0;!F();){t&&t==C()&&a("INFINITE LOOP POSSIBLE ON STATEMENT ".concat(t.Source," :"),t),t=C();var E=r(K(u,s),2),v=(E[0],E[1]);if(v)switch(o.push(v),v.Type){case"LocalVarStat":v.VarList.forEach((function(e){e.UseCount=0,e.Number=g++,u[e.Source]=e;var n=[];function t(){e.UseCount++,n.forEach((function(n){n.UseCount=e.UseCount}))}e.Tokens={},e.Tokens.push=function(o){o.UseCountIncrease=t,o.UseCount=e.UseCount,o.Tokens=e.Tokens,n.push(o)},e.Tokens.get=function(){return n},e.UseCountIncrease=t}));break;case"LocalFunctionStat":var _=v.FunctionStat.NameChain;1===_.length&&function(){var e=function(){n.UseCount++,t.forEach((function(e){e.UseCount=n.UseCount}))},n=_[0];n.UseCount=0,n.Number=g++,u[n.Source]=n;var t=[];n.Tokens={},n.Tokens.push=function(o){o.UseCountIncrease=e,o.UseCount=n.UseCount,o.Tokens=n.Tokens,t.push(o)},n.Tokens.get=function(){return t},n.UseCountIncrease=e}()}var x=C();"Symbol"==x.Type&&";"==x.Source&&(i[o.length-1]=l())}return m={Type:"StatList",StatementList:o,SemicolonList:i,GetFirstToken:function(){return 0==m.StatementList.length?void 0:m.StatementList[0].GetFirstToken()},GetLastToken:function(){return 0==m.StatementList.length?void 0:m.SemicolonList[m.StatementList.length-1]?m.SemicolonList[m.StatementList.length-1]:m.StatementList[m.StatementList.length-1].GetLastToken()}}},n([],[])}function x(e,n){for(var t,i,a={BinopExpr:!0,UnopExpr:!0,NumberLiteral:!0,StringLiteral:!0,NilLiteral:!0,BooleanLiteral:!0,VargLiteral:!0,HashLiteral:!0,FieldExpr:!0,IndexExpr:!0,MethodExpr:!0,CallExpr:!0,FunctionLiteral:!0,VariableExpr:!0,ParenExpr:!0,TableLiteral:!0},u={StatList:!0,BreakStat:!0,ContinueStat:!0,ReturnStat:!0,LocalVarStat:!0,LocalFunctionStat:!0,FunctionStat:!0,RepeatStat:!0,GenericForStat:!0,NumericForStat:!0,WhileStat:!0,DoStat:!0,IfStat:!0,CallExprStat:!0,AssignmentStat:!0,CompoundStat:!0},l=0,s=Object.entries(n);l<s.length;l++){var c=r(s[l],2),f=c[0];if(c[1],!u[f]&&!a[f])throw"Invalid visitor target: `".concat(f,"`")}function T(e){if(null!=e){var t=n[e.Type];if("function"==typeof t)return t(e);if(t&&t.Pre)return t.Pre(e)}}function p(e){var t=n[e.Type];if(t&&"object"==o(t)&&t.Post)return t.Post(e)}t=function(e){if(!T(e)){if("BinopExpr"==e.Type)t(e.Lhs),t(e.Rhs);else if("UnopExpr"==e.Type)t(e.Rhs);else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type);else if("FieldExpr"==e.Type)t(e.Base);else if("IndexExpr"==e.Type)t(e.Base),t(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)t(e.Base),"ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach((function(e,n){t(e)})):"TableCall"==e.FunctionArguments.CallType&&t(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)i(e.Body);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type)t(e.Expression);else if("TableLiteral"==e.Type)e.EntryList.forEach((function(e,n){if("Field"==e.EntryType)t(e.Value);else if("Index"==e.EntryType)t(e.Index),t(e.Value);else{if("Value"!=e.EntryType)throw"unreachable";t(e.Value)}}));else{if("CompoundStat"!=e.Type)throw"unreachable, type: ".concat(e.Type,": ").concat(e);t(e.Lhs),t(e.Rhs)}p(e)}},i=function(e){if(!T(e)){if("StatList"==e.Type)e.StatementList.forEach((function(n,t){if(null!=n){if(null===n||null===n.Type)return;n.Remove=function(){e.StatementList[t]=null},i(n)}}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach((function(e,n){t(e)}));else if("LocalVarStat"==e.Type)e.Token_Equals&&e.ExprList.forEach((function(e,n){t(e)}));else if("LocalFunctionStat"==e.Type)i(e.FunctionStat.Body);else if("FunctionStat"==e.Type)i(e.Body);else if("RepeatStat"==e.Type)i(e.Body),t(e.Condition);else if("GenericForStat"==e.Type)e.GeneratorList.forEach((function(e,n){t(e)})),i(e.Body);else if("NumericForStat"==e.Type)e.RangeList.forEach((function(e,n){t(e)})),i(e.Body);else if("WhileStat"==e.Type)t(e.Condition),i(e.Body);else if("DoStat"==e.Type)i(e.Body);else if("IfStat"==e.Type)t(e.Condition),i(e.Body),e.ElseClauseList.forEach((function(e){null!=e.Condition&&t(e.Condition),i(e.Body)}));else if("CallExprStat"==e.Type)t(e.Expression);else if("CompoundStat"==e.Type)t(e.Lhs),t(e.Rhs);else{if("AssignmentStat"!=e.Type)throw"unreachable";e.Lhs.forEach((function(e){t(e)})),e.Rhs.forEach((function(e){t(e)}))}p(e)}},u[e.Type]?i(e):t(e)}function F(e){var n,t=[],o=0;function r(){return++o}function i(){(n={ParentScope:n,ChildScopeList:[],VariableList:[],BeginLocation:r(),Depth:null,GetVar:null}).ParentScope?(n.Depth=n.ParentScope.Depth+1,n.ParentScope.ChildScopeList.push(n)):n.Depth=1;var e=n;n.GetVar=function(n){if(e.VariableList.forEach((function(e){if(e.Name==n)return e})),e.ParentScope)return e.ParentScope.GetVar(n);t.forEach((function(e){if(e.Name==n)return e}))}}function a(){var e=n;return e.EndLocation=r(),e.VariableList.forEach((function(n){n.ScopeEndLocation=e.EndLocation})),n=e.ParentScope,e}function l(e,t,o){u(o,"MIssing localInfo"),u(e,"Missing local var name");var i={Type:"Local",Name:e,RenameList:[t],AssignedTo:!1,Info:o,Scope:n,BeginLocation:r(),EndLocation:r(),ReferenceLocationList:[r()],Rename:function(e){i.Name=e,i.RenameList.forEach((function(n){n(e)}))}};return n.VariableList.push(i),i}function s(e,n){u(e,"Missing var name");var o=function(e){t.forEach((function(n){if(n.Name==e)return n}));var n={Type:"Global",Name:e,RenameList:[],AssignedTo:!1,Scope:null,BeginLocation:r(),EndLocation:r(),ReferenceLocationList:[],Rename:function(e){n.Name=e,n.RenameList.forEach((function(n){n(e)}))}};return t.push(n),n}(e);return o.RenameList.push(n),o}function c(e,n){var t;for(t=e.VariableList.length-1;t>=0;t--)if(e.VariableList[t].Name==n)return e.VariableList[t];if(e.ParentScope){var o=c(e.ParentScope,n);if(o)return o}}function f(e,t){u(e,"Missing var name");var o=c(n,e);o?o.RenameList.push(t):o=s(e,t);var i=r();return o.EndLocation=i,o.ReferenceLocationList.push(o.EndLocation),o}i();var T={};return T.FunctionLiteral={Pre:function(e){i(),e.ArgList.forEach((function(e,n){var t=l(e.Source,(function(n,t){t||(e.Source=n)}),{Type:"Argument",Index:n});e.var=t}))},Post:function(e){a()}},T.VariableExpr=function(e){e.Variable=f(e.Token.Source,(function(n){e.Token.Source=n}))},T.StatList={Pre:function(e){i()},Post:function(e){e.SkipPop||a()}},T.LocalVarStat={Post:function(e){e.VarList.forEach((function(n,t){l(n.Source,(function(n){e.VarList[t].Source=n}),{Type:"Local"})}))}},T.LocalFunctionStat={Pre:function(e){l(e.FunctionStat.NameChain[0].Source,(function(n){e.FunctionStat.NameChain[0].Source=n}),{Type:"LocalFunction"}),i(),e.FunctionStat.ArgList.forEach((function(e,n){l(e.Source,(function(n){e.Source=n}),{Type:"Argument",Index:n})}))},Post:function(){a()}},T.FunctionStat={Pre:function(e){var t=e.NameChain;(1==t.length?c(n,t[0].Source)?f(t[0].Source,(function(e){t[0].Source=e})):s(t[0].Source,(function(e){t[0].Source=e})):f(t[0].Source,(function(e){t[0].Source=e}))).AssignedTo=!0,i(),e.ArgList.forEach((function(e,n){l(e.Source,(function(n){e.Source=n}),{Type:"Argument",Index:n})}))},Post:function(){a()}},T.GenericForStat={Pre:function(e){return e.GeneratorList.forEach((function(e){x(e,T)})),i(),e.VarList.forEach((function(e,n){l(e.Source,(function(n){e.Source=n}),{Type:"ForRange",Index:n})})),x(e.Body,T),a(),!0}},T.NumericForStat={Pre:function(e){return e.RangeList.forEach((function(e){x(e,T)})),i(),e.VarList.forEach((function(e,n){l(e.Source,(function(n){e.Source=n}),{Type:"ForRange",Index:n})})),x(e.Body,T),a(),!0}},T.RepeatStat={Pre:function(e){e.Body.SkipPop=!0},Post:function(e){a()}},T.AssignmentStat={Post:function(e){e.Lhs.forEach((function(e){null!=e.Variable&&(e.Variable.AssignedTo=!0)}))}},x(e,T),[t,a()]}function b(e){var n,t,o="";function r(e){if(null==e.LeadingWhite||null==e.Source)throw"Bad token: tk=".concat(e," | lwhite=").concat(e.LeadingWhite," | source=").concat(e.Source);o="".concat(o).concat(e.LeadingWhite).concat(e.Source)}return t=function(e){if("BinopExpr"==e.Type)t(e.Lhs),r(e.Token_Op),t(e.Rhs);else if("UnopExpr"==e.Type)r(e.Token_Op),t(e.Rhs);else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type)r(e.Token);else if("FieldExpr"==e.Type)t(e.Base),r(e.Token_Dot),r(e.Field);else if("IndexExpr"==e.Type)t(e.Base),r(e.Token_OpenBracket),t(e.Index),r(e.Token_CloseBracket);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)t(e.Base),"MethodExpr"==e.Type&&(r(e.Token_Colon),r(e.Method)),"StringCall"==e.FunctionArguments.CallType?r(e.FunctionArguments.Token):"ArgCall"==e.FunctionArguments.CallType?(r(e.FunctionArguments.Token_OpenParen),e.FunctionArguments.ArgList.forEach((function(n,o){t(n);var i=e.FunctionArguments.Token_CommaList[o];null!=i&&r(i)})),r(e.FunctionArguments.Token_CloseParen)):"TableCall"==e.FunctionArguments.CallType&&t(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)r(e.Token_Function),r(e.Token_OpenParen),e.ArgList.forEach((function(n,t){r(n);var o=e.Token_ArgCommaList[t];null!=o&&r(o)})),null!=e.Token_Varg&&r(e.Token_Varg),r(e.Token_CloseParen),n(e.Body),r(e.Token_End);else if("VariableExpr"==e.Type)r(e.Token);else if("ParenExpr"==e.Type)r(e.Token_OpenParen),t(e.Expression),r(e.Token_CloseParen);else if("TableLiteral"==e.Type)r(e.Token_OpenBrace),e.EntryList.forEach((function(n,o){if("Field"==n.EntryType)r(n.Field),r(n.Token_Equals),t(n.Value);else if("Index"==n.EntryType)r(n.Token_OpenBracket),t(n.Index),r(n.Token_CloseBracket),r(n.Token_Equals),t(n.Value);else{if("Value"!=n.EntryType)throw"unreachable";t(n.Value)}var i=e.Token_SeperatorList[o];null!=i&&r(i)})),r(e.Token_CloseBrace);else{if("CompoundStat"!=e.Type)throw"unreachable, type: ".concat(e.Type,": ").concat(e);n(e)}},(n=function(e){if(null==e)throw"STAT IS NIL! ".concat(e);"StatList"==e.Type?e.StatementList.forEach((function(t,o){null!==t&&null!==t.Type&&(t.Remove=function(){e.StatementList[o]=null},n(t),e.SemicolonList[o]&&r(e.SemicolonList[o]))})):"BreakStat"==e.Type?r(e.Token_Break):"ContinueStat"==e.Type?r(e.Token_Continue):"ReturnStat"==e.Type?(r(e.Token_Return),e.ExprList.forEach((function(n,o){t(n),e.Token_CommaList[o]&&r(e.Token_CommaList[o])}))):"LocalVarStat"==e.Type?(r(e.Token_Local),e.VarList.forEach((function(n,t){r(n);var o=e.Token_VarCommaList[t];null!=o&&r(o)})),null!=e.Token_Equals&&(r(e.Token_Equals),e.ExprList.forEach((function(n,o){t(n);var i=e.Token_ExprCommaList[o];null!=i&&r(i)})))):"LocalFunctionStat"==e.Type?(r(e.Token_Local),r(e.FunctionStat.Token_Function),r(e.FunctionStat.NameChain[0]),r(e.FunctionStat.Token_OpenParen),e.FunctionStat.ArgList.forEach((function(n,t){r(n);var o=e.FunctionStat.Token_ArgCommaList[t];null!=o&&r(o)})),e.FunctionStat.Token_Varg&&r(e.FunctionStat.Token_Varg),r(e.FunctionStat.Token_CloseParen),n(e.FunctionStat.Body),r(e.FunctionStat.Token_End)):"FunctionStat"==e.Type?(r(e.Token_Function),e.NameChain.forEach((function(n,t){r(n);var o=e.Token_NameChainSeperator[t];null!=o&&r(o)})),r(e.Token_OpenParen),e.ArgList.forEach((function(n,t){r(n);var o=e.Token_ArgCommaList[t];null!=o&&r(o)})),e.Token_Varg&&r(e.Token_Varg),r(e.Token_CloseParen),n(e.Body),r(e.Token_End)):"RepeatStat"==e.Type?(r(e.Token_Repeat),n(e.Body),r(e.Token_Until),t(e.Condition)):"GenericForStat"==e.Type?(r(e.Token_For),e.VarList.forEach((function(n,t){r(n);var o=e.Token_VarCommaList[t];null!=o&&r(o)})),r(e.Token_In),e.GeneratorList.forEach((function(n,o){t(n);var i=e.Token_GeneratorCommaList[o];null!=i&&r(i)})),r(e.Token_Do),n(e.Body),r(e.Token_End)):"NumericForStat"==e.Type?(r(e.Token_For),e.VarList.forEach((function(n,t){r(n);var o=e.Token_VarCommaList[t];null!=o&&r(o)})),r(e.Token_Equals),e.RangeList.forEach((function(n,o){t(n);var i=e.Token_RangeCommaList[o];null!=i&&r(i)})),r(e.Token_Do),n(e.Body),r(e.Token_End)):"WhileStat"==e.Type?(r(e.Token_While),t(e.Condition),r(e.Token_Do),n(e.Body),r(e.Token_End)):"DoStat"==e.Type?(r(e.Token_Do),n(e.Body),r(e.Token_End)):"IfStat"==e.Type?(r(e.Token_If),t(e.Condition),r(e.Token_Then),n(e.Body),e.ElseClauseList.forEach((function(e){r(e.Token),null!=e.Condition&&(t(e.Condition),r(e.Token_Then)),n(e.Body)})),r(e.Token_End)):"CallExprStat"==e.Type?t(e.Expression):"CompoundStat"==e.Type?(t(e.Lhs),r(e.Token_Compound),t(e.Rhs),e.Type="CompoundStat"):"AssignmentStat"==e.Type?(e.Lhs.forEach((function(n,o){t(n);var i=e.Token_LhsSeperatorList[o];null!=i&&r(i)})),r(e.Token_Equals),e.Rhs.forEach((function(n,o){t(n);var i=e.Token_RhsSeperatorList[o];null!=i&&r(i)}))):u(!1,"unreachable")})(e),o}function B(e){var n,t;function o(e){e&&(e.LeadingWhite="")}function r(e,n){var t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];o(n);var r=("string"==typeof e.Source?e.Source:e.Source.toString()).substr(e.Source.length-1,1),i=("string"==typeof n.Source?n.Source:n.Source.toString()).substr(0,1);"-"==r&&"-"==i||T.includes(r)&&T.includes(i)||t&&")"==r&&"("==i?n.LeadingWhite=t?";":" ":n.LeadingWhite=""}function i(e,t,i){n(t),o(i);var a=t.GetFirstToken(),u=t.GetLastToken();null!=a?(r(e,a),r(u,i)):r(e,i)}t=function(e){if("BinopExpr"===e.Type)t(e.Lhs),o(e.Token_Op),t(e.Rhs),r(e.Token_Op,e.Rhs.GetFirstToken()),r(e.Lhs.GetLastToken(),e.Token_Op);else if("UnopExpr"===e.Type)o(e.Token_Op),t(e.Rhs),r(e.Token_Op,e.Rhs.GetFirstToken());else if("NumberLiteral"===e.Type||"StringLiteral"===e.Type||"NilLiteral"===e.Type||"BooleanLiteral"===e.Type||"VargLiteral"===e.Type||"HashLiteral"===e.Type)o(e.Token);else if("FieldExpr"==e.Type)t(e.Base),o(e.Token_Dot),o(e.Field);else if("IndexExpr"==e.Type)t(e.Base),o(e.Token_OpenBracket),t(e.Index),o(e.Token_CloseBracket);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)t(e.Base),"MethodExpr"==e.Type&&(o(e.Token_Colon),o(e.Method)),"StringCall"==e.FunctionArguments.CallType?o(e.FunctionArguments.Token):"ArgCall"==e.FunctionArguments.CallType?(o(e.FunctionArguments.Token_OpenParen),e.FunctionArguments.ArgList.forEach((function(n,r){t(n);var i=e.FunctionArguments.Token_CommaList[r];null!=i&&o(i)})),o(e.FunctionArguments.Token_CloseParen)):"TableCall"==e.FunctionArguments.CallType&&t(e.FunctionArguments.TableExpr);else if("FunctionLiteral"==e.Type)o(e.Token_Function),o(e.Token_OpenParen),e.ArgList.forEach((function(n,t){o(n);var r=e.Token_ArgCommaList[t];null!=r&&o(r)})),null!=e.Token_Varg&&o(e.Token_Varg),o(e.Token_CloseParen),i(e.Token_CloseParen,e.Body,e.Token_End);else if("VariableExpr"==e.Type)o(e.Token);else if("ParenExpr"==e.Type)o(e.Token_OpenParen),t(e.Expression),o(e.Token_CloseParen);else{if("TableLiteral"!=e.Type)throw"unreachable, type: ".concat(e.Type,":").concat(e,"  ").concat(console.trace());o(e.Token_OpenBrace),e.EntryList.forEach((function(n,r){"Field"==n.EntryType?(o(n.Field),o(n.Token_Equals),t(n.Value)):"Index"==n.EntryType?(o(n.Token_OpenBracket),t(n.Index),o(n.Token_CloseBracket),o(n.Token_Equals),t(n.Value)):"Value"==n.EntryType?t(n.Value):u(!1,"unreachable");var i=e.Token_SeperatorList[r];null!=i&&o(i)})),e.Token_SeperatorList[e.EntryList.length-1]=null,o(e.Token_CloseBrace)}},(n=function(e){if("StatList"==e.Type){var a;for(a=0;a<=e.StatementList.length;a++){var u=e.StatementList[a];if(null!=u){n(u),o(u.GetFirstToken());var l=e.StatementList[a-1];if(null!=l){var s={")":["(","["],"]":["(","["]};if(e.SemicolonList[a-1]){var c=l.GetLastToken().Source,f=u.GetFirstToken().Source;null!==s[c]&&void 0!==s[c]&&s[c].includes(f)||(e.SemicolonList[a-1]=null)}e.SemicolonList[a-1]||r(l.GetLastToken(),u.GetFirstToken(),!0)}}}e.SemicolonList[e.StatementList.length-1]=null,e.StatementList.length>0&&o(e.StatementList[0].GetFirstToken())}else if("BreakStat"==e.Type)o(e.Token_Break);else if("ContinueStat"==e.Type)o(e.Token_Continue);else if("ReturnStat"==e.Type)o(e.Token_Return),e.ExprList.forEach((function(n,r){t(n),null!=e.Token_CommaList[r]&&o(e.Token_CommaList[r])})),e.ExprList.length>0&&r(e.Token_Return,e.ExprList[0].GetFirstToken());else if("LocalVarStat"==e.Type)o(e.Token_Local),e.VarList.forEach((function(n,t){0==t?r(e.Token_Local,n):o(n);var i=e.Token_VarCommaList[t];null!=i&&o(i)})),null!=e.Token_Equals&&(o(e.Token_Equals),e.ExprList.forEach((function(n,r){t(n);var i=e.Token_ExprCommaList[r];null!=i&&o(i)})));else if("LocalFunctionStat"==e.Type)o(e.Token_Local),r(e.Token_Local,e.FunctionStat.Token_Function),r(e.FunctionStat.Token_Function,e.FunctionStat.NameChain[0]),r(e.FunctionStat.NameChain[0],e.FunctionStat.Token_OpenParen),e.FunctionStat.ArgList.forEach((function(n,t){o(n);var r=e.FunctionStat.Token_ArgCommaList[t];null!=r&&o(r)})),e.FunctionStat.Token_Varg&&o(e.FunctionStat.Token_Varg),o(e.FunctionStat.Token_CloseParen),i(e.FunctionStat.Token_CloseParen,e.FunctionStat.Body,e.FunctionStat.Token_End);else if("FunctionStat"==e.Type)o(e.Token_Function),e.NameChain.forEach((function(n,t){0==t?r(e.Token_Function,n):o(n);var i=e.Token_NameChainSeperator[t];null!=i&&o(i)})),o(e.Token_OpenParen),e.ArgList.forEach((function(n,t){o(n);var r=e.Token_ArgCommaList[t];null!=r&&o(r)})),e.Token_Varg&&o(e.Token_Varg),o(e.Token_CloseParen),i(e.Token_CloseParen,e.Body,e.Token_End);else if("RepeatStat"==e.Type)o(e.Token_Repeat),i(e.Token_Repeat,e.Body,e.Token_Until),t(e.Condition),r(e.Token_Until,e.Condition.GetFirstToken());else if("GenericForStat"==e.Type)o(e.Token_For),e.VarList.forEach((function(n,t){0==t?r(e.Token_For,n):o(n);var i=e.Token_VarCommaList[t];null!=i&&o(i)})),r(e.VarList[e.VarList.length-1],e.Token_In),e.GeneratorList.forEach((function(n,i){t(n),0==i&&r(e.Token_In,n.GetFirstToken());var a=e.Token_GeneratorCommaList[i];null!=a&&o(a)})),r(e.GeneratorList[e.GeneratorList.length-1].GetLastToken(),e.Token_Do),i(e.Token_Do,e.Body,e.Token_End);else if("NumericForStat"==e.Type)o(e.Token_For),e.VarList.forEach((function(n,t){0==t?r(e.Token_For,n):o(n);var i=e.Token_VarCommaList[t];null!=i&&o(i)})),r(e.VarList[e.VarList.length-1],e.Token_Equals),e.RangeList.forEach((function(n,i){t(n),0==i&&r(e.Token_Equals,n.GetFirstToken());var a=e.Token_RangeCommaList[i];null!=a&&o(a)})),r(e.RangeList[e.RangeList.length-1].GetLastToken(),e.Token_Do),i(e.Token_Do,e.Body,e.Token_End);else if("WhileStat"==e.Type)o(e.Token_While),t(e.Condition),o(e.Token_Do),r(e.Token_While,e.Condition.GetFirstToken()),r(e.Condition.GetLastToken(),e.Token_Do),i(e.Token_Do,e.Body,e.Token_End);else if("DoStat"==e.Type)o(e.Token_Do),o(e.Token_End),i(e.Token_Do,e.Body,e.Token_End);else if("IfStat"==e.Type){o(e.Token_If),t(e.Condition),r(e.Token_If,e.Condition.GetFirstToken()),r(e.Condition.GetLastToken(),e.Token_Then);var T=e.Token_Then,p=e.Body;e.ElseClauseList.forEach((function(e,o){i(T,p,e.Token),T=e.Token,null!=e.Condition&&(t(e.Condition),r(e.Token,e.Condition.GetFirstToken()),r(e.Condition.GetLastToken(),e.Token_Then),T=e.Token_Then),n(e.Body),p=e.Body})),i(T,p,e.Token_End)}else if("CallExprStat"==e.Type)t(e.Expression);else if("CompoundStat"==e.Type)t(e.Lhs),o(e.Token_Compound),t(e.Rhs),r(e.Lhs.GetLastToken(),e.Token_Compound),r(e.Token_Compound,e.Rhs.GetFirstToken());else{if("AssignmentStat"!=e.Type)return t(e);e.Lhs.forEach((function(n,r){t(n);var i=e.Token_LhsSeperatorList[r];null!=i&&o(i)})),o(e.Token_Equals),e.Rhs.forEach((function(n,r){t(n);var i=e.Token_RhsSeperatorList[r];null!=i&&o(i)}))}})(e)}function G(e){var n,t,i={NumberLiteral:!0,BooleanLiteral:!0,StringLiteral:!0,HashLiteral:!0,NilLiteral:!0,TableLiteral:!0,ParenExpr:!0,BinopExpr:!0};function a(e,n){var t,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return t={Type:e,Token:{Type:null==o?"Number":o,LeadingWhite:"",Source:n},GetFirstToken:function(){return t.Token},GetLastToken:function(){return t.Token}}}function s(e,n){var t;return t={Type:"UnopExpr",Token_Op:{Type:"Symbol",LeadingWhite:"",Source:e},Rhs:n,GetFirstToken:function(){return t.Token_Op},GetLastToken:function(){return t.Rhs.GetLastToken()}}}function c(e,n){if(null!=n)for(var t=0,o=Object.entries(n);t<o.length;t++){var i=r(o[t],2),a=i[0],u=i[1];e[a]=u}}function f(e){if(null!=e&&null!=e.substr){var n,t=e.substr(0,1);if('"'!=t&&"'"!=t||(n=e.substr(1,e.length-2)),"["==t){for(var o=0,r=1;"="==e.substr(r,1);)o++,r++;n=e.substr(2+o,e.length-4-o-2)}if(null==n)return"";var i,a="";for(i=0;i<=n.length;i++){var u=n.substr(i,1);a+="'"==u||'"'==u?"\\".concat(u):u}return a}}function T(e){if("object"==o(e)&&"ParenExpr"==e.Type)return c(e,e.Expression)}t=function(e){if("BinopExpr"==e.Type){if(t(e.Lhs),t(e.Rhs),null!=e.Lhs&&null!=e.Rhs){var r=e.Token_Op;if(null!=r&&null!=r.Source){var p=function(e,n,t){var o=n,r=t;if(n&&"ParenExpr"==n.Type&&(o=n.Expression),t&&"ParenExpr"==t.Type&&(r=t.Expression),null!=o&&null!=r&&null!=o.Type&&null!=r.Type&&"VariableExpr"!=o.Type&&"CallExpr"!=o.Type&&"BinopExpr"!=o.Type&&"CallExpr"!=r.Type&&"BinopExpr"!=r.Type&&"VariableExpr"!=r.Type){var i,a,u=o.Token||null!=o.Expression&&o.Expression.Token||null,s=r.Token||null!=r.Expression&&r.Expression.Token||null,c=null!=u?u.Source:null,T=null!=s?s.Source:null;if("BooleanLiteral"==o.Type&&(i="true"==c),"BooleanLiteral"==r.Type&&(a="true"==T),!("NumberLiteral"==o.Type&&null==(i=l(c))||"NumberLiteral"==r.Type&&null==(a=l(T))||("StringLiteral"!=o.Type&&"HashLiteral"!=o.Type||(i=c.toString()),"StringLiteral"!=r.Type&&"HashLiteral"!=r.Type||(a=T.toString()),null==i||null==a))){if("=="==e)return i==a;if("~="==e)return i!=a;if("and"==e)return i&&a;if("or"==e)return i||a;if(".."==e&&"StringLiteral"==o.Type&&"StringLiteral"==r.Type)return'"'.concat(f(c)+f(T),'"');if("StringLiteral"==o.Type&&(i=l(f(i))),"StringLiteral"==r.Type&&(a=l(f(a))),null==i||null==a)return;var p;if("+"==e&&(p=i+a),"-"==e&&(p=i-a),"*"==e&&(p=i*a),"/"==e&&(p=i/a),"^"==e&&(p=Math.pow(i,a)),"%"==e&&(p=i%a),">"==e&&(p=i>a),"<"==e&&(p=i<a),">="==e&&(p=i>=a),"<="==e&&(p=i<=a),0==p||1==p||isFinite(p)&&p>-Math.pow(10,6)&&p<Math.pow(10,6))return p}}}(r.Source,e.Lhs,e.Rhs);if(null!=p){if("boolean"==typeof p){var h=a("BooleanLiteral",p.toString(),"Keyword");return void c(e,h)}if("number"==typeof p){if(1==isFinite(p)){var y=a("NumberLiteral",p.toString(),"Number");return void c(e,y)}}else{if("string"==typeof p){var k=a("StringLiteral",p,"String");return void c(e,k)}if("object"==o(p))return void c(e,p)}return}}if("ParenExpr"==e.Lhs.Type){var L=e.Lhs.Expression;"NumberLiteral"==L.Type||"StringLiteral"==L.Type||"NilLiteral"==L.Type||"BooleanLiteral"==L.Type||L.Type}if("ParenExpr"==e.Rhs.Type){var d=e.Rhs.Expression;"NumberLiteral"==d.Type||"StringLiteral"==d.Type||"NilLiteral"==d.Type||"BooleanLiteral"==d.Type||d.Type}}}else if("UnopExpr"==e.Type){if(t(e.Rhs),null!=e.Rhs&&1==i[e.Rhs.Type]){var S=e.Token_Op;if(null!=S&&null!=S.Source){var m=null!=e.Rhs.Expression?e.Rhs.Expression:e.Rhs,g=function(e,n){var t=n.Token||n.Expression||n.EntryList||n;if(null!=t&&(null!=t.Source||"TableLiteral"==n.Type)&&"VariableExpr"!=n.Type&&"CallExpr"!=n.Type&&"BinopExpr"!=n.Type){var o,r=t.Source;if("TableLiteral"==n.Type&&null!=t){var i=[],u=0,c=!1,f=!1,T=0;if(t.forEach((function(e,n){if(c)i.push(e);else if("Value"==e.EntryType||"Index"==e.EntryType)if(null!=e.Index&&"NumberLiteral"!=e.Index.Type||!e.Value)i.push(e);else{if((null!=e.Index&&null!=e.Index.Token&&null!==e.Index.Token.Source?e.Index.Token.Source:T+1).toString()!==(++T).toString())return c=!0,f=!0,i.push(e);"CallExpr"!=e.Value.Type?u++:(c=!0,i.push(e))}})),f)return;if("#"==e){if(n.EntryList=i,n.EntryList.length<=0)return a("NumberLiteral",null!==u?u:n.EntryList.length);if(u<=0)return s("#",n);var p=function(e,n,t){var o;return o={Type:"BinopExpr",Token_Op:{Type:"Symbol",LeadingWhite:"",Source:"+"},Lhs:n,Rhs:t,GetFirstToken:function(){return o.Lhs.GetFirstToken()},GetLastToken:function(){return o.Rhs.GetLastToken()}}}(0,a("NumberLiteral",u),s("#",n));return p}}if("BooleanLiteral"==n.Type&&(o="true"==r),"NumberLiteral"!=n.Type||null!==(o=l(r))){if("StringLiteral"==n.Type&&(o=r.substr(1,r.length-2)),"not"==e&&null!==n.Type)return"NilLiteral"==n.Type||"BooleanLiteral"==n.Type&&!1===o;if(null!=o){if("#"==e)return o.length;if("-"==e)return-o}}}}(S.Source,m);if(null!=g){if("boolean"==typeof g){var E=a("BooleanLiteral",g.toString(),"Keyword");return void c(e,E)}if("number"==typeof g){if(1==isFinite(g)){var v=a("NumberLiteral",g,"Number");return void c(e,v)}}else{if("string"==typeof g){var _=a("StringLiteral",g,"String");return void c(e,_)}if("object"==o(g))return void c(e,g)}return}}}}else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type){var C=e.Token;if(null!=C){if("Number"==C.Type){var x=C.Source.toString().split("e");if(2===x.length){var F=l(x[0]),b=l(x[1]);isFinite(F)&&isFinite(b)&&Math.pow(F,b)<999999999&&(C.Source=Math.pow(F,b).toString())}}"String"==C.Type&&(C.Source=C.Source.replace(/\\\d+/gi,(function(e){var n=l(e.substr(1,e.length-1));return n&&isFinite(n)&&(n>=97&&n<=122||n>=65&&n<=90||n>=33&&n<=47||n>=58&&n<=64||n>=91&&n<=96||n>=123&&n<=126)&&34!==n&&39!==n&&92!==n?String.fromCharCode(n):e})))}}else if("FieldExpr"==e.Type)t(e.Base);else if("IndexExpr"==e.Type)t(e.Base),t(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type){if(t(e.Base),"ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach((function(e,n){t(e)})):"TableCall"==e.FunctionArguments.CallType&&t(e.FunctionArguments.TableExpr),"ParenExpr"===e.Base.Type&&"FunctionLiteral"===e.Base.Expression.Type&&"ArgCall"===e.FunctionArguments.CallType){var B=e.Base.Expression;e.FunctionArguments.ArgList.forEach((function(n,t){var o=e.FunctionArguments.ArgList[t];if(void 0!==o&&("NumberLiteral"==o.Type||"StringLiteral"==o.Type||"NilLiteral"==o.Type||"BooleanLiteral"==o.Type||"HashLiteral"==o.Type)){var r=B.ArgList[t];r&&r.var.RenameList.forEach((function(e){e(o.Token.Source,!0)}))}}))}}else if("FunctionLiteral"==e.Type)n(e.Body);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type){var G=e.Expression;null!=G&&"ParenExpr"==G.Type&&(e.Expression=G.Expression),t(e.Expression),"NumberLiteral"!=e.Type&&"StringLiteral"!=e.Type&&"NilLiteral"!=e.Type&&"BooleanLiteral"!=e.Type&&"VargLiteral"!=e.Type&&"HashLiteral"!=e.Type||T(e)}else"TableLiteral"==e.Type&&e.EntryList.forEach((function(e,n){"Field"==e.EntryType?t(e.Value):"Index"==e.EntryType?(t(e.Index),t(e.Value)):"Value"==e.EntryType?t(e.Value):u(!1,"unreachable")}))},(n=function(e){if("StatList"==e.Type)e.StatementList.forEach((function(t,o){null!==t&&null!==t.Type&&(t.Remove=function(){e.StatementList[o]=null},n(t))}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach((function(e,n){t(e)}));else if("LocalVarStat"==e.Type)null!=e.Token_Equals&&e.ExprList.forEach((function(e,n){t(e)}));else if("LocalFunctionStat"==e.Type)n(e.FunctionStat.Body),1===e.FunctionStat.NameChain.length&&e.FunctionStat.NameChain[0].UseCount;else if("FunctionStat"==e.Type)n(e.Body);else if("RepeatStat"==e.Type)n(e.Body),t(e.Condition),"StatList"==e.Body.Type&&e.Body.StatementList.length;else if("GenericForStat"==e.Type)e.GeneratorList.forEach((function(e,n){t(e)})),n(e.Body);else if("NumericForStat"==e.Type){e.RangeList.forEach((function(e,n){t(e)})),n(e.Body);var o=e.RangeList[0],r=e.RangeList[1],i=e.RangeList[2];if(null==o||null==r)return e.Remove();if(T(o),T(r),T(i),"NumberLiteral"!=o.Type||"NumberLiteral"!=r.Type||null!=i&&"NumberLiteral"!=i.Type||null==i)return;var a=l(o.Token.Source),u=l(r.Token.Source),s=null!=i&&l(i.Token.Source)||1;if(!((s>0&&a<=u||s<0&&a>=u)&&(u-a+s)/s>=0))return e.Remove();if("StatList"==e.Body.Type&&0===e.Body.StatementList.length)return e.Remove()}else if("WhileStat"==e.Type){t(e.Condition),n(e.Body);var f=e.Condition;switch(f.Type){case"ParenExpr":f=f.Expression;case"BooleanLiteral":if(null==f||null==f.Token||"false"!==f.Token.Source)break;case"NilLiteral":e.Remove()}}else if("DoStat"==e.Type){if(n(e.Body),null===e.Body||"StatList"==e.Body.Type&&0===e.Body.StatementList.length)return e.Remove();if(1===e.Body.StatementList.length){var p=e.Body.StatementList[0];"ContinueStat"!==p.Type&&"BreakStat"!==p.Type&&"ReturnStat"!==p.Type&&c(e,p)}}else if("IfStat"==e.Type){t(e.Condition),n(e.Body),e.ElseClauseList.forEach((function(e,o){null!=e.Condition&&t(e.Condition),n(e.Body)}));var h=e.Condition;switch(h.Type){case"ParenExpr":h=h.Expression;case"BooleanLiteral":if(e.ElseClauseList.length>=1||null==h||null==h.Token||"false"!==h.Token.Source)break;case"NilLiteral":e.Remove()}}else"CallExprStat"==e.Type?t(e.Expression):"CompoundStat"==e.Type?(t(e.Lhs),t(e.Rhs)):"AssignmentStat"==e.Type&&(e.Lhs.forEach((function(e,n){t(e)})),e.Rhs.forEach((function(e,n){t(e)})))})(e)}var V,R=[];for(V="a".charCodeAt();V<="z".charCodeAt();V++)R.push(String.fromCharCode(V));for(V="A".charCodeAt();V<="Z".charCodeAt();V++)R.push(String.fromCharCode(V));for(V="0".charCodeAt();V<="9".charCodeAt();V++)R.push(String.fromCharCode(V));R.push("_");var A=[];for(V="a".charCodeAt();V<="z".charCodeAt();V++)A.push(String.fromCharCode(V));for(V="A".charCodeAt();V<="Z".charCodeAt();V++)A.push(String.fromCharCode(V));function w(e){var n="",t=e%A.length;for(e=(e-t)/A.length,n="".concat(n).concat(A[t]);e>0;){var o=e%R.length;e=(e-o)/R.length,n="".concat(n).concat(R[o])}return n}var N={Minify:function(e,n){var t=C(e),o=r(F(t),2),i=o[0],a=o[1];1==n.RenameVariables&&function(e,n,t){for(var o=[],i=0,a=Object.entries(m);i<a.length;i++){var u=r(a[i],2),l=u[0];u[1],o[l]=!0}var s=[],c=[];e.forEach((function(e){e.AssignedTo&&t?s.push(e):o[e.Name]=!0})),function e(n){n.VariableList.forEach((function(e){s.push(e),c.push(e)})),n.ChildScopeList.forEach((function(n){e(n)}))}(n),s.forEach((function(e){e.UsedNameArray=[]})),s.sort((function(e,n){return e-n}));var f=0,T=[];s.forEach((function(e,n){e.Renamed=!0;for(var t=0;e.UsedNameArray[t];)t++;e.Rename(function(e){var n=T[e];if(null==n){for(n=w(f),f++;o[n];)n=w(f),f++;T[e]=n}return n}(t)),e.Scope?s.forEach((function(n){n.Renamed||(!n.Scope||n.Scope.Depth<e.Scope.Depth?n.ReferenceLocationList.some((function(o){return o>=e.BeginLocation&&o<=e.ScopeEndLocation&&(n.UsedNameArray[t]=!0,!0)})):n.Scope.Depth>e.Scope.Depth?e.ReferenceLocationList.some((function(e){return e>=n.BeginLocation&&e<=n.ScopeEndLocation&&(n.UsedNameArray[t]=!0,!0)})):e.BeginLocation<n.EndLocation&&e.EndLocation>n.BeginLocation&&(n.UsedNameArray[t]=!0))})):s.forEach((function(n){if(!n.Renamed)if("Global"==n.Type)n.UsedNameArray[t]=!0;else{if("Local"!=n.Type)throw"Unreachable";e.ReferenceLocationList.some((function(e){return e>=n.BeginLocation&&e<=n.ScopeEndLocation&&(n.UsedNameArray[t]=!0,!0)}))}}))}))}(i,a,n.RenameGlobals),1==n.SolveMath&&G(t),B(t);var u=b(t);return"".concat(u)},Beautify:function(e,n){var t=C(e),o=r(F(t),2),i=o[0],l=o[1];n.RenameVariables&&function(e,n,t){var o=[];e.forEach((function(e){e.AssignedTo&&t||(o[e.Name]=!0)}));var r=1,i=1;function a(e,n){e.Name=n,e.RenameList.forEach((function(e){e(n)}))}if(t){var u={};e.forEach((function(e){e.AssignedTo&&!e.ChangedName&&(u[e.Name]=u[e.Name]||"G_".concat(i,"_"),e.ChangedName=!0,a(e,u[e.Name]),i++)}))}!function e(n){n.VariableList.forEach((function(e){var n="L_".concat(r,"_");"Argument"==e.Info.Type?n="".concat(n,"arg").concat(e.Info.Index):"LocalFunction"==e.Info.Type?n="".concat(n,"func"):"ForRange"==e.Info.Type&&(n="".concat(n,"forvar").concat(e.Info.Index)),a(e,n),r++})),n.ChildScopeList.forEach((function(n){e(n)}))}(n)}(i,l,n.RenameGlobals),1==n.SolveMath&&G(t),function(e){var n,t,o=0;function r(e){var n="\n".concat("\t".repeat(o));if(""==e.LeadingWhite||e.LeadingWhite.substr(-n.length,n.length)!=n){var t,r="";for(t=e.LeadingWhite.length;t>=0;t--){var i=e.LeadingWhite.substr(t,1);if(""!=i&&!i.match(/\s/g)){r=e.LeadingWhite.substr(0,t+1);break}}e.LeadingWhite="".concat(r).concat(n)}}function i(){o++}function l(){o--,u(o>=0,"Undented too far")}function c(e){e.LeadingWhite=e.LeadingWhite.trim()}function f(e){c(e),s.includes(function(e){return e.LeadingWhite.length>0?e.LeadingWhite.substr(0,1):e.Source.toString().substr(0,1)}(e))||(e.LeadingWhite=" "+e.LeadingWhite)}function T(e){f(e.GetFirstToken())}function p(e,t,o){i(),n(t),l(),r(o)}t=function(e){if("BinopExpr"==e.Type)t(e.Lhs),t(e.Rhs),T(e.Rhs),f(e.Token_Op);else if("UnopExpr"==e.Type)c(e.Token_Op),t(e.Rhs),e.Token_Op.Source[0]&&f(e.Rhs.GetFirstToken());else if("NumberLiteral"==e.Type||"StringLiteral"==e.Type||"NilLiteral"==e.Type||"BooleanLiteral"==e.Type||"VargLiteral"==e.Type||"HashLiteral"==e.Type)c(e.Token),"HashLiteral"==e.Type&&(e.Token.Source='"'+function(e){for(var n=0,t=e.length;t--;)n+=e.charCodeAt(t),n+=n<<10,n^=n>>6;return n+=n<<3,(n^=n>>11)+(n<<15)}("".concat(e.Token.Source.substring(1,e.Token.Source.length-1)))+'"',e.Type="StringLiteral",e.Token.Type="String");else if("FieldExpr"==e.Type)t(e.Base);else if("IndexExpr"==e.Type)t(e.Base),t(e.Index);else if("MethodExpr"==e.Type||"CallExpr"==e.Type)t(e.Base),c(e.FunctionArguments.GetFirstToken()),c(e.FunctionArguments.GetLastToken()),e.Type,"StringCall"==e.FunctionArguments.CallType||("ArgCall"==e.FunctionArguments.CallType?e.FunctionArguments.ArgList.forEach((function(n,o){t(n),o>0&&T(n);var r=e.FunctionArguments.Token_CommaList[o];null!=r&&c(r)})):"TableCall"==e.FunctionArguments.CallType&&t(e.FunctionArguments.TableExpr));else if("FunctionLiteral"==e.Type)e.ArgList.forEach((function(n,t){t>0&&f(n),e.Token_ArgCommaList[t]})),e.ArgList.length>0&&null!=e.Token_Varg&&f(e.Token_Varg),p(e.Token_CloseParen,e.Body,e.Token_End);else if("VariableExpr"==e.Type);else if("ParenExpr"==e.Type)c(e.Token_OpenParen),c(e.Token_CloseParen),t(e.Expression);else if("TableLiteral"==e.Type)if(0==e.EntryList.length);else{i();var o=100;e.EntryList.forEach((function(n,i){"Field"==n.EntryType?(e.EntryList.length>o?B(n.Value):r(n.Field),f(n.Token_Equals),t(n.Value),T(n.Value)):"Index"==n.EntryType?(e.EntryList.length>o?c(n.Token_OpenBracket):r(n.Token_OpenBracket),t(n.Index),f(n.Token_Equals),t(n.Value),T(n.Value)):"Value"==n.EntryType?(t(n.Value),e.EntryList.length>o?B(n.Value):r(n.Value.GetFirstToken())):u(!1,"unreachable");var a=e.Token_SeperatorList[i];null!=a&&(e.EntryList.length>o?a.LeadingWhite="":c(a))})),l(),e.EntryList.length>o?e.Token_CloseBrace.LeadingWhite="":r(e.Token_CloseBrace)}else{if("CompoundStat"!=e.Type)throw a(e),"unreachable, type: ".concat(e.Type,":")+e;n(e)}},(n=function(e){if("StatList"==e.Type)e.StatementList.forEach((function(e,t){null!==e&&null!==e.Type&&(e.Remove=function(){e.StatementList[t]=null},n(e),r(e.GetFirstToken()))}));else if("BreakStat"==e.Type);else if("ContinueStat"==e.Type);else if("ReturnStat"==e.Type)e.ExprList.forEach((function(n,o){t(n),T(n),e.Token_CommaList[o]}));else if("LocalVarStat"==e.Type){if(e.VarList.forEach((function(n,t){f(n),e.Token_VarCommaList[t]})),e.Token_Equals){c(e.Token_Equals),f(e.Token_Equals);var o=[],i=[];e.ExprList.forEach((function(n,t){null!=n&&(t<e.VarList.length?(o.push(n),i.push(e.Token_ExprCommaList[t])):"CallExpr"!=n.Type&&"ParenExpr"!=n.Type&&"VargLiteral"!=n.Type&&"BinopExpr"!=n.Type&&"UnopExpr"!=n.Type||(o.push(n),i.push(e.Token_ExprCommaList[t])))})),e.ExprList=o,e.CommaList=i,e.ExprList.forEach((function(n,o){null!=n&&(t(n),T(n),null!=e.Token_ExprCommaList[o]&&e.ExprList.length-1==o&&(e.Token_ExprCommaList[o]=null))}))}}else if("LocalFunctionStat"==e.Type)f(e.FunctionStat.Token_Function),f(e.FunctionStat.NameChain[0]),e.FunctionStat.ArgList.forEach((function(n,t){t>0?f(n):c(n);var o=e.FunctionStat.Token_ArgCommaList[t];o&&c(o)})),e.FunctionStat.ArgList.length>0&&e.FunctionStat.Token_Varg?(c(e.FunctionStat.Token_Varg),f(e.FunctionStat.Token_Varg)):e.FunctionStat.Token_Varg&&c(e.FunctionStat.Token_Varg),c(e.FunctionStat.Token_OpenParen),c(e.FunctionStat.Token_CloseParen),p(e.FunctionStat.Token_CloseParen,e.FunctionStat.Body,e.FunctionStat.Token_End);else if("FunctionStat"==e.Type)e.NameChain.forEach((function(n,t){0==t&&f(n),e.Token_NameChainSeperator[t]})),e.ArgList.forEach((function(n,t){t>0&&f(n),e.Token_ArgCommaList[t]})),e.ArgList.length>0&&e.Token_Varg&&f(e.Token_Varg),p(e.Token_CloseParen,e.Body,e.Token_End);else if("RepeatStat"==e.Type)p(e.Token_Repeat,e.Body,e.Token_Until),t(e.Condition),T(e.Condition);else if("GenericForStat"==e.Type)e.VarList.forEach((function(n,t){f(n),e.Token_VarCommaList[t]})),f(e.Token_In),e.GeneratorList.forEach((function(n,o){t(n),T(n),e.Token_GeneratorCommaList[o]})),f(e.Token_Do),p(e.Token_Do,e.Body,e.Token_End);else if("NumericForStat"==e.Type)e.VarList.forEach((function(n,t){f(n),e.Token_VarCommaList[t]})),f(e.Token_Equals),e.RangeList.forEach((function(n,o){t(n),T(n),e.Token_RangeCommaList[o]})),f(e.Token_Do),p(e.Token_Do,e.Body,e.Token_End);else if("WhileStat"==e.Type)t(e.Condition),T(e.Condition),f(e.Token_Do),p(e.Token_Do,e.Body,e.Token_End);else if("DoStat"==e.Type)p(e.Token_Do,e.Body,e.Token_End);else if("IfStat"==e.Type){t(e.Condition),T(e.Condition),f(e.Token_Then),e.Token_Then;var a=e.Body;e.ElseClauseList.forEach((function(e){p(0,a,e.Token),e.Token,null!=e.Condition&&(t(e.Condition),T(e.Condition),f(e.Token_Then),e.Token_Then),a=e.Body})),p(0,a,e.Token_End)}else"CallExprStat"==e.Type?t(e.Expression):"CompoundStat"==e.Type?(t(e.Lhs),t(e.Rhs),T(e.Lhs),T(e.Rhs),f(e.Token_Compound)):"AssignmentStat"==e.Type?(e.Lhs.forEach((function(n,o){t(n),o>0&&T(n),e.Token_LhsSeperatorList[o]})),f(e.Token_Equals),e.Rhs.forEach((function(n,o){t(n),T(n),e.Token_RhsSeperatorList[o]}))):u(!1,"Unreachable")})(e)}(t);var c=b(t);return"".concat(c)}};try{null!=e&&null!=e.exports&&(e.exports.Beautify=N.Beautify,e.exports.Minify=N.Minify)}catch(e){}},316:function(e,n,t){var o=t(872).default;function r(){"use strict";e.exports=r=function(){return n},e.exports.__esModule=!0,e.exports.default=e.exports;var n={},t=Object.prototype,i=t.hasOwnProperty,a=Object.defineProperty||function(e,n,t){e[n]=t.value},u="function"==typeof Symbol?Symbol:{},l=u.iterator||"@@iterator",s=u.asyncIterator||"@@asyncIterator",c=u.toStringTag||"@@toStringTag";function f(e,n,t){return Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}),e[n]}try{f({},"")}catch(e){f=function(e,n,t){return e[n]=t}}function T(e,n,t,o){var r=n&&n.prototype instanceof y?n:y,i=Object.create(r.prototype),u=new b(o||[]);return a(i,"_invoke",{value:_(e,t,u)}),i}function p(e,n,t){try{return{type:"normal",arg:e.call(n,t)}}catch(e){return{type:"throw",arg:e}}}n.wrap=T;var h={};function y(){}function k(){}function L(){}var d={};f(d,l,(function(){return this}));var S=Object.getPrototypeOf,m=S&&S(S(B([])));m&&m!==t&&i.call(m,l)&&(d=m);var g=L.prototype=y.prototype=Object.create(d);function E(e){["next","throw","return"].forEach((function(n){f(e,n,(function(e){return this._invoke(n,e)}))}))}function v(e,n){function t(r,a,u,l){var s=p(e[r],e,a);if("throw"!==s.type){var c=s.arg,f=c.value;return f&&"object"==o(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(e){t("next",e,u,l)}),(function(e){t("throw",e,u,l)})):n.resolve(f).then((function(e){c.value=e,u(c)}),(function(e){return t("throw",e,u,l)}))}l(s.arg)}var r;a(this,"_invoke",{value:function(e,o){function i(){return new n((function(n,r){t(e,o,n,r)}))}return r=r?r.then(i,i):i()}})}function _(e,n,t){var o="suspendedStart";return function(r,i){if("executing"===o)throw new Error("Generator is already running");if("completed"===o){if("throw"===r)throw i;return{value:void 0,done:!0}}for(t.method=r,t.arg=i;;){var a=t.delegate;if(a){var u=C(a,t);if(u){if(u===h)continue;return u}}if("next"===t.method)t.sent=t._sent=t.arg;else if("throw"===t.method){if("suspendedStart"===o)throw o="completed",t.arg;t.dispatchException(t.arg)}else"return"===t.method&&t.abrupt("return",t.arg);o="executing";var l=p(e,n,t);if("normal"===l.type){if(o=t.done?"completed":"suspendedYield",l.arg===h)continue;return{value:l.arg,done:t.done}}"throw"===l.type&&(o="completed",t.method="throw",t.arg=l.arg)}}}function C(e,n){var t=e.iterator[n.method];if(void 0===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=void 0,C(e,n),"throw"===n.method))return h;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return h}var o=p(t,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,h;var r=o.arg;return r?r.done?(n[e.resultName]=r.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,h):r:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,h)}function x(e){var n={tryLoc:e[0]};1 in e&&(n.catchLoc=e[1]),2 in e&&(n.finallyLoc=e[2],n.afterLoc=e[3]),this.tryEntries.push(n)}function F(e){var n=e.completion||{};n.type="normal",delete n.arg,e.completion=n}function b(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(x,this),this.reset(!0)}function B(e){if(e){var n=e[l];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var t=-1,o=function n(){for(;++t<e.length;)if(i.call(e,t))return n.value=e[t],n.done=!1,n;return n.value=void 0,n.done=!0,n};return o.next=o}}return{next:G}}function G(){return{value:void 0,done:!0}}return k.prototype=L,a(g,"constructor",{value:L,configurable:!0}),a(L,"constructor",{value:k,configurable:!0}),k.displayName=f(L,c,"GeneratorFunction"),n.isGeneratorFunction=function(e){var n="function"==typeof e&&e.constructor;return!!n&&(n===k||"GeneratorFunction"===(n.displayName||n.name))},n.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,L):(e.__proto__=L,f(e,c,"GeneratorFunction")),e.prototype=Object.create(g),e},n.awrap=function(e){return{__await:e}},E(v.prototype),f(v.prototype,s,(function(){return this})),n.AsyncIterator=v,n.async=function(e,t,o,r,i){void 0===i&&(i=Promise);var a=new v(T(e,t,o,r),i);return n.isGeneratorFunction(t)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},E(g),f(g,c,"Generator"),f(g,l,(function(){return this})),f(g,"toString",(function(){return"[object Generator]"})),n.keys=function(e){var n=Object(e),t=[];for(var o in n)t.push(o);return t.reverse(),function e(){for(;t.length;){var o=t.pop();if(o in n)return e.value=o,e.done=!1,e}return e.done=!0,e}},n.values=B,b.prototype={constructor:b,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(F),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,o){return a.type="throw",a.arg=e,n.next=t,o&&(n.method="next",n.arg=void 0),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var r=this.tryEntries[o],a=r.completion;if("root"===r.tryLoc)return t("end");if(r.tryLoc<=this.prev){var u=i.call(r,"catchLoc"),l=i.call(r,"finallyLoc");if(u&&l){if(this.prev<r.catchLoc)return t(r.catchLoc,!0);if(this.prev<r.finallyLoc)return t(r.finallyLoc)}else if(u){if(this.prev<r.catchLoc)return t(r.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<r.finallyLoc)return t(r.finallyLoc)}}}},abrupt:function(e,n){for(var t=this.tryEntries.length-1;t>=0;--t){var o=this.tryEntries[t];if(o.tryLoc<=this.prev&&i.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var r=o;break}}r&&("break"===e||"continue"===e)&&r.tryLoc<=n&&n<=r.finallyLoc&&(r=null);var a=r?r.completion:{};return a.type=e,a.arg=n,r?(this.method="next",this.next=r.finallyLoc,h):this.complete(a)},complete:function(e,n){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&n&&(this.next=n),h},finish:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.finallyLoc===e)return this.complete(t.completion,t.afterLoc),F(t),h}},catch:function(e){for(var n=this.tryEntries.length-1;n>=0;--n){var t=this.tryEntries[n];if(t.tryLoc===e){var o=t.completion;if("throw"===o.type){var r=o.arg;F(t)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,t){return this.delegate={iterator:B(e),resultName:n,nextLoc:t},"next"===this.method&&(this.arg=void 0),h}},n}e.exports=r,e.exports.__esModule=!0,e.exports.default=e.exports},872:function(e){function n(t){return e.exports=n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,n(t)}e.exports=n,e.exports.__esModule=!0,e.exports.default=e.exports},93:function(e,n,t){function o(e){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o(e)}var r=t(316)();e.exports=r;try{regeneratorRuntime=r}catch(e){"object"===("undefined"==typeof globalThis?"undefined":o(globalThis))?globalThis.regeneratorRuntime=r:Function("r","regeneratorRuntime = r")(r)}}},n={};function t(o){var r=n[o];if(void 0!==r)return r.exports;var i=n[o]={id:o,loaded:!1,exports:{}};return e[o](i,i.exports,t),i.loaded=!0,i.exports}t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e},function(){"use strict";function e(e,n,t,o,r,i,a){try{var u=e[i](a),l=u.value}catch(e){return void t(e)}u.done?n(l):Promise.resolve(l).then(o,r)}function n(n){return function(){var t=this,o=arguments;return new Promise((function(r,i){var a=n.apply(t,o);function u(n){e(a,r,i,u,l,"next",n)}function l(n){e(a,r,i,u,l,"throw",n)}u(void 0)}))}}function o(e,n){for(var t=0;t<n.length;t++){var o=n[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}var r=t(93),i=t.n(r),a=JSON.parse('{"id":"acode.plugin.lua.format"}');function u(e,n){!function(e,n){if(n.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}(e,n),n.add(e)}function l(e,n,t){if(!n.has(e))throw new TypeError("attempted to get private field on non-instance");return t}var s=t(418),c=a.id,f={RenameVariables:!1,RenameGlobals:!1,SolveMath:!1},T=new WeakSet,p=new WeakSet,h=new WeakSet,y=function(){function e(){var n;!function(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,h),u(this,p),u(this,T),(n="worker")in this?Object.defineProperty(this,n,{value:null,enumerable:!0,configurable:!0,writable:!0}):this[n]=null,this.run=this.run.bind(this)}var t,r,y,L,S,m;return t=e,r=[{key:"init",value:(m=n(i().mark((function e(){var n;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=["lua"],acode.registerFormatter(c,n,this.run);case 2:case"end":return e.stop()}}),e,this)}))),function(){return m.apply(this,arguments)})},{key:"run",value:(S=n(i().mark((function n(){var t,o,r,a,u,c,p;return i().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:t=editorManager,o=t.editor,r=t.activeFile,a=r.session,u=o.getValue(),c=o.getCursorPosition(),e.inferParser(r.name),l(this,T,k).call(this,c),r.name,appSettings.value.tabSize,p=s.Beautify(u,f),l(this,h,d).call(this,a,p);case 8:case"end":return n.stop()}}),n,this)}))),function(){return S.apply(this,arguments)})},{key:"destroy",value:(L=n(i().mark((function e(){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:acode.unregisterFormatter(a.id);case 1:case"end":return e.stop()}}),e)}))),function(){return L.apply(this,arguments)})}],y=[{key:"inferParser",value:function(e){return"lua"===e.slice(e.lastIndexOf(".")+1)?"lua":null}}],r&&o(t.prototype,r),y&&o(t,y),Object.defineProperty(t,"prototype",{writable:!1}),e}();function k(e){for(var n=e.row,t=e.column,o=editorManager.editor.getValue().split("\n"),r=0;r<n-1;r++)t+=o[r].length;return t}function L(e){for(var n=editorManager.editor.getValue().split("\n"),t=0,o=0,r=0;r<n.length;r++){if(o+n[r].length>=e){t=r,o=e-o;break}o+=n[r].length}return{row:t,column:o}}function d(e,n){var t=Object.assign({},e.getUndoManager()),o=t.$undoStack,r=t.$redoStack,i=t.$rev,a=t.$mark;e.setValue(n);var u=e.getUndoManager();u.$undoStack=o,u.$redoStack=r,u.$rev=i,u.$mark=a;var s=l(this,p,L).call(this,n.cursorOffset),c=s.row,f=s.column;e.selection.moveCursorTo(c,f)}if(window.acode){var S=new y;acode.setPluginInit(a.id,(function(e,n,t){var o=t.cacheFileUrl,r=t.cacheFile;e.endsWith("/")||(e+="/"),S.baseUrl=e,S.init(n,r,o)})),acode.setPluginUnmount(a.id,(function(){S.destroy()}))}}()}();